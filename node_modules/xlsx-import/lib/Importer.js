"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Importer = /** @class */ (function () {
    function Importer(wb) {
        this.wb = wb;
    }
    Importer.prototype.GetAllItems = function (cfg) {
        var ws = this.wb.getWorksheet(cfg.worksheet);
        var result = [];
        switch (cfg.type) {
            case 'object':
                var objectCfg = cfg;
                var singleton_1 = {};
                objectCfg.fields.forEach(function (fieldCfg) {
                    var mapper = fieldCfg.mapper || (function (v) { return v; });
                    singleton_1[fieldCfg.key] = mapper(ws.getCell(fieldCfg.row, fieldCfg.col).text);
                });
                result.push(singleton_1);
                break;
            case 'list':
            default:
                var listCfg_1 = cfg;
                ws.eachRow(function (row, i) {
                    if (i <= listCfg_1.rowOffset) {
                        return;
                    }
                    var item = {};
                    listCfg_1.columns.forEach(function (colCfg) {
                        var mapper = colCfg.mapper || (function (v) { return v; });
                        item[colCfg.key] = mapper(row.getCell(colCfg.index).text);
                    });
                    result.push(item);
                });
                break;
        }
        return result;
    };
    return Importer;
}());
exports.default = Importer;
//# sourceMappingURL=Importer.js.map